# cibook

## 効果検証入門

技術評論社発行の書籍のサンプルコードです。

https://gihyo.jp/book/2020/978-4-297-11117-5

データ元

http://www.minethatdata.com/Kevin_Hillstrom_MineThatData_E-MailAnalytics_DataMiningChallenge_2008.03.20.csv

## 用語紹介
セレクションバイアス
> 比較しているグループの潜在的な傾向(その他の要素)が違うことによって発生するバイアス。eg:メール配信の分析

RCT(無作為比較試験, Randomized Controlled Trial)
> 施策の割り当てをランダムにし、介入が行われたグループと介入が行われていないグループの比較を可能にする。"因果推論の根本問題"を限りなく解消する。eg:ABテスト

ポテンシャルアウトカムフレームワーク(Potential Outcome Framework)
> 介入が行われた結果γ1と行われなかった結果γ2があると考え、その差に介入の本当の効果があるという考え

ポテンシャルアウトカム(Potential Outcome)
> 実際には観測されない側の結果のこと

ATE(Average Treatment Effect, 平均処置効果)
> 母集団における介入を受けた場合の売り上げの平均と介入を受けなかった場合の売り上げの平均の差。これは効果とすると過剰に見積もる可能性がある
```
τ = E[γ1] - E[γ0]
E[γ1] = E[γ0]+ τ

* ある変数(Z)をある値を取るときの、別の変数(γ)の期待値のことを条件付き期待値という
* E[γ1|Z = 1]は Z = 1となるサンプルに限定した時のγ1の期待値ということ

T(naive) 
    = E[γ1|Z = 1] - E[γ0|Z = 0]
    = E[γ1|Z = 1] - E[γ0|Z = 1] + E[γ0|Z = 1] - E[γ0|Z = 0]
    = E[γ1-γ0|Z = 1] (+ E[γ0|Z = 1] - E[γ0|Z = 0])←セレクションバイアス
    = E[γ1-γ0](本来の介入効果) + E[γ0|Z = 1] - E[γ0|Z = 0](実際に介入が行われたが効果がなかったものから実際に介入が行われずに効果がなかったものを差し引いている)



```